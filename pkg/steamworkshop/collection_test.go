package steamworkshop_test

import (
	"bytes"
	_ "embed"
	"testing"

	"github.com/MatthiasKunnen/boiler/pkg/steamworkshop"
	"github.com/stretchr/testify/assert"
)

//go:embed testdata/collection_details_961618554.json
var collection961618554 []byte

func TestCollectionDetailsApiFromReader(t *testing.T) {
	actual, err := steamworkshop.CollectionDetailsApiFromReader(bytes.NewReader(collection961618554), 961618554)
	assert.NoError(t, err)
	expected := []steamworkshop.CollectionDetailApi{
		{
			CollectionId: 961618554,
			Items: []steamworkshop.CollectionDetailItem{
				{450814997, 0, 0},
				{463939057, 1, 0},
				{333310405, 2, 0},
				{410206202, 3, 0},
				{520618345, 4, 0},
				{314397752, 5, 0},
				{952560410, 6, 0},
				{935053587, 7, 0},
				{766566053, 8, 0},
				{378364543, 9, 0},
				{962772573, 10, 0},
				{820994401, 11, 0},
				{909547724, 12, 0},
				{501966277, 13, 0},
				{421839251, 14, 0},
				{500929500, 15, 0},
				{501552467, 16, 0},
				{665702172, 16, 2},
				{613191867, 17, 0},
				{642912021, 18, 0},
				{671539540, 19, 0},
				{583496184, 20, 0},
				{769440155, 22, 0},
				{696414736, 23, 0},
				{168892601, 24, 0},
				{647753401, 25, 0},
				{843425103, 26, 0},
				{497660133, 27, 0},
				{730310357, 28, 0},
				{843770737, 28, 2},
				{713709341, 29, 0},
				{752130537, 29, 2},
				{639837898, 30, 0},
				{911433699, 31, 0},
				{498740884, 32, 0},
				{332909923, 33, 0},
				{699728548, 34, 0},
				{843577117, 35, 0},
				{667454606, 36, 0},
				{1334412770, 37, 0},
				{1341958961, 38, 0},
				{884988618, 39, 0},
				{448333775, 40, 0},
				{457905859, 41, 0},
				{723217262, 42, 0},
				{330927362, 43, 0},
				{771298211, 44, 0},
				{1317730184, 45, 0},
				{1310581330, 46, 0},
				{1208270228, 47, 0},
				{1358695565, 49, 0},
				{898362689, 50, 0},
				{935654483, 51, 0},
				{875972034, 52, 0},
				{730005323, 53, 2},
				{1231094504, 53, 0},
				{877549706, 54, 2},
				{1126511665, 54, 0},
				{1260802825, 55, 0},
				{366425329, 56, 0},
				{1069036154, 57, 0},
				{1110394854, 58, 0},
				{1111155085, 59, 0},
				{887302721, 60, 0},
				{1195230287, 61, 0},
				{243821832, 62, 0},
				{667953829, 63, 0},
				{588179142, 64, 0},
				{815962700, 66, 0},
				{669902348, 68, 0},
				{1270139905, 69, 0},
				{1212932880, 70, 0},
				{648775794, 71, 0},
				{1203678801, 72, 0},
				{530168603, 73, 0},
				{702907405, 75, 0},
				{1334394234, 77, 0},
				{1160452826, 78, 0},
				{1277446594, 79, 0},
				{612930542, 80, 0},
				{643530417, 81, 0},
				{330941960, 82, 0},
				{328962087, 83, 0},
				{932001853, 84, 0},
				{882138618, 85, 0},
				{882136076, 86, 0},
				{1115246886, 88, 0},
				{539126468, 89, 0},
				{633936703, 90, 0},
				{388697912, 91, 0},
				{1099020839, 92, 0},
				{897168981, 93, 0},
				{815366548, 94, 0},
				{1459724182, 95, 0},
				{1450865805, 96, 0},
				{1123074587, 97, 2},
				{1443557392, 99, 0},
				{582444910, 100, 0},
				{1470493486, 101, 0},
			},
		},
	}
	assert.Equal(t, expected, actual)
}
